-----------------
MD5 信息摘要算法
-----------------

关于本备忘录

    本备忘录为 Internet 社区提供信息。它没有指定一个 Internet 标准。分发本备忘录是没有\
    限制的。

致谢

    我们对提出许多有益的意见和建议的 Don Coppersmith, Burt Kaliski, Ralph Merkle, \
    David Chaum, 和 Noam Nisan 表示感谢。

目录

1. 执行摘要_
#. 术语和符号_
#. `MD5 算法描述`_
#. 摘要_
#. `MD4 和 MD5 的差异`_

* `参考文献`_
* `附录 A - 参考实例`_
* `安全注意事项`_
* `作者地址`_ 

.. _执行摘要:

.. 执行摘要

1. 执行摘要
------------

本文档记述了 MD5 信息摘要算法。该算法将任意长度的信息作为输入，并输出一个输入信息的\
128位的 “指纹” 或者 “信息摘要”。据推测，生成两个具有相同信息摘要的信息，或者生成预\
定目标信息摘要的任何信息，在计算上是不可行的。MD5 算法适用于应用程序的数字签名，在\
使用诸如 RSA 之类的公钥加密系统的私有（秘密）秘钥对其进行加密之前，必须先以安全的方\
式压缩大文件。

MD5 算法被设计的非常快在32位计算机上。另外，MD5 算法不需要任何庞大的置换表；该算法\
可以非常紧凑地编码。

MD5 算法是 MD4 信息摘要算法 [1]_ [2]_ 的拓展。MD5 算法稍慢于 MD4 算法，但是在设计\
上更为“保守”。MD5 算法之所以被设计，是因为人们认为 MD4 算法可能被采纳为比现有的重要\
审查所证明的合理的速度还要快；正因为 MD4 被设计地出乎意料的快，所以在成功的密码分析\
攻击分析方面，它处于“边缘”。MD5 稍微后退了一点儿，为了提高最终安全性而放弃了一些速\
度。它包含了各位审阅者提出的一些建议，并包含了额外的优化。MD5 算法正在公共领域中进\
行审查，并有可能被采纳为标准。

对于基于 OSI 的应用程序，MD5的对象标识符为：

.. code-block:: 

    md5 OBJECT IDENTIFIER ::=
    iso(1) member-body(2) US(840) rsadsi(113549) digestAlgorithm(2) 5}

在 X.509 类型的算法识别符 [3]_ 中，MD5 算法的参数应该包含 NULL 类型。

.. _术语和符号:

.. 术语和符号

2. 术语和符号
-------------

在本文档中，一个 “字（word）” 是 32 位长度，一个 “字节（byte）” 是 8 位长度。可以\
按自然的方式将位（bit）序列解释为字节序列，其中，每 8 位连续的位被解释为一个字节，每\
个字节的高位（最高有效位）位于第一位。相似地，字节序列可以解释为 32 位的字，其中每 \
4 个连续的字节被解释为一个字，每个字的低位（最低有效位）位于第一位。

用 x_i 表示 “x 的下标 i”，如果下标是一个表达式，我们将它放在大括号内，如 x_{i+1}。\
同样地，我们使用 ``^`` 表示上标（取幂），以便 x^i 表示 x 的第 i 次幂。

令符号 “+” 表示 字 的加法运算（即模 2^32 加法）。令 ``X <<< s`` 表示通过将 X 向左\
循环移位 s 个位而取得 32 位的值。令 ``not(x)`` 表示 x 的按位补码，令 ``X v Y`` \
表示 X 和 Y 的按位或运算。令 ``X xor Y`` 表示 X 和 Y 的按位异或运算， ``XY`` 表\
示 X 和 Y 的按位与运算。

.. _MD5 算法描述:

.. MD5 算法描述

3. MD5 算法描述
---------------

首先我们假设有一个 b 位的信息作为输入，并且希望找到其信息摘要。这里的 b 是一个任意\
的非负整数；b 可以为零，不必为 8 的倍数，而且可以任意大。我们假设将消息的各个部分记\
录如下:

    m_0 m_1 ... m_{b-1}

接下来的 5 个步骤来计算消息的信息摘要。

3.1 步骤 1. 填充比特
~~~~~~~~~~~~~~~~~~~~~

对该消息进行“填充（拓展）”，以使其长度（以 bit 为单位）等于 448，以512为模。即，\
对该消息进行拓展，使它的长度比 512 位的整数倍长度少 64 位。消息填充是始终进行的，\
即使消息的长度已经等于 448（以512位模）。

填充操作如下：将单个的 "1" 添加到消息中，然后添加 "0"，以使填充消息的位长度等于 \
448，模数为 512。总之，至少 1 位，至多 512 位会被填充。

3.2 步骤 2. 附加长度
~~~~~~~~~~~~~~~~~~~~~

b 的 64 位表示形式（填充数据之前）将附加到上一步的结果中。如果 b 大于 2^64，则\
仅使用 b 的低 64 位（根据以前的惯例，这些位被附加为两个 32 字，并首先附加到低位。）

此时，结果消息（用位填充和 b 填充之后）的长度时 512 位的精确倍数。同样，此消息的\
长度是 16 （32 位）字的整数倍。令 M[0 ... N-1] 表示结果消息的字，其中 N 是 16 \
的倍数。

3.3 步骤 3. 初始化 MD 缓冲区
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

一个四字缓冲区（A, B, C, D）用于计算信息摘要。在此，A, B, C, D 均为 32 位寄存\
器。这些寄存器被初始化为以下值（十六进制，低位在前）：

.. code-block:: text

    A: 01 23 45 67
    B: 89 ab cd ef
    C: fe dc ba 98
    D: 76 54 32 10

3.4 步骤 4. 以 16 字块形式处理消息
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

我们首先定义四个辅助函数，每个辅助函数将三个32位字作为输入，并产生一个32位字作为\
输出。

.. code-block:: text

    F(X,Y,Z) = XY v not(X) Z
    G(X,Y,Z) = XZ v Y not(Z)
    H(X,Y,Z) = X xor Y xor Z
    I(X,Y,Z) = Y xor (X v not(Z))


.. _摘要:

.. 摘要

4. 摘要
---------

.. _MD4 和 MD5 的差异:

.. MD4 和 MD5 的差异

5. MD4 和 MD5 的差异
--------------------

.. _参考文献:

参考文献


.. [1] Rivest, R., "The MD4 Message Digest Algorithm",RFC 1320, MIT and RSA \
       Data Security, Inc., April 1992.

.. [2] Rivest, R., "The MD4 message digest algorithm", in A.J.  Menezes and \
       S.A. Vanstone, editors, Advances in Cryptology - CRYPTO '90 \
       Proceedings, pages 303-311, Springer-Verlag, 1991.

.. [3] CCITT Recommendation X.509 (1988), "The Directory Authentication \
       Framework."

.. _附录 a - 参考实例:

附录 a - 参考实例

.. _安全注意事项:

安全注意事项

.. _作者地址:

作者地址
